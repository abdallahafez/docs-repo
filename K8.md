# k8 
![arch](./k8/1.svg)
* يتكون من :
  * worker and manager node 
  ## Manager node
### API server 
* بداخله الكثير من المكونات
* يمكنك أن تتكلم معه بأكثر من طريقة مثل :
1. command line (kubectl)
2. Dashboard (ليس اﻷفضل )
3. API interface 
   1. Python
   2. Java
### etcd
* هي قاعدة البيانات التي بها جميع الإعدادات الخاصة بال cluster
* high available 
* k8 can be backup from it 
### schduler 
it responsible to create dyployment like pods 
### controller manager 
* مسؤلة أن تقارن الحالة الحلية بالحالة المرغوبة 
  * current status to desired status 
    ## Worker node 
    ### kubelet
  * هوا الذي يقوم بالتحدث مع الوركر 
    ### kube proxy 
  * هو المسؤل عن كل ما يمت للنتورك بصلة  

# Installation
* يمكنك تصطيب كوبرناتس بأكثر من طريقة
  * multinodes (manger and workers node not on the same machine)
    * cloud wiether on VM or native install 
  * تنزيل جميع المكونات على ماكينة واحدة 
    * this can be done through minikube
    * this can be done on container or VM .
  * manger node can be installed only on linux till now .

### K8 is not container runtime , K8 is not natively creating the containers , it is using something else like :
*  docker runtime 
*  Runc
*  LXC

 ويمكنك تحديد أي منهم ليستخدمه والمفضل لديه هو دوكر 

### Donloading and install minikube on ubuntu
* https://minikube.sigs.k8s.io/docs/start/?arch=%2Flinux%2Fx86-64%2Fstable%2Fbinary+download
### install kubectl 
* snap install kubectl --classic
### both of them needs to be downloade on vm and you need to enable nested VM
```bash
VBoxManage modifyvm k8 --nested-hw-virt on
#the command suggested by deepsek but I do not need it 
minikube start
minikube start --driver virtualbox/docker
```
اﻷمر السابق قام بانشاء ماكنة على virtualbox 
VM name is minikube 

minikube status/start/restart/stop
kubectl cluster-info
give you the cluster IP 
minikube dashboard
it is one of addons provied by k8 

# dashboard fast look 
* name space is a logical grouping of component related to service or deplyment  
kubectl get nodes 
NAME       STATUS   ROLES           AGE   VERSION
minikube   Ready    control-plane   23m   v1.32.0
kubectl get nodes -o wide 
for more info 


# K8 arch
1. HA (قبل الكارثة)
2. scalability
3. DR (بعد الكرثة)
* الوحدة اﻷساسية لكوبرناتس هي البود وليس الدوكر 
* يحتوي البود على أكثر من كونتينر يمكن أن يكون لنفس الشيئ ويمكن أن يختلفا the same service or different 
* the deployment and replication will be on the pod level not on the container 
* the deployment is a group of pods 
  * abstraction layer
  * يتم فيه تحديد طريقة التحديث وعدد البود (number of replica and the update type )
  * images and many things 
* The service is a group of deployment
  * the deplyment is abstraction layer send the request to the available deployment and replicate it for HA 
  * the user can deal with service 
* ingres network load balse the requests to the services and it contains the DNS and user can deal with it 
* PV should known to persistat volume 
* config map relate the 
  * config map like DB
  * to avoid changing from oracle to mysql 
  

# sample deployment 
* https://kubernetes.io/docs/tutorials/kubernetes-basics/deploy-app/deploy-intro/
* kubectl get all - kubectl get deployments 
## start the DP
* kubectl create deployment kubernetes-bootcamp --image=gcr.io/google-samples/kubernetes-bootcamp:v1
  * DP name = kubernetes-bootcamp
* kubectl proxy
  * بدأ البروكسي والذي يقوم بتشغيل كل ما له علاقة بالنتورك 
* curl http://localhost:8001/api/v1/namespaces/default(the name space)/pods/$POD_NAME:8080/proxy/
  * curl http://localhost:8001/api/v1/namespaces/default/pods/kubernetes-bootcamp-9bc58d867-d5pfj:8080/proxy/


